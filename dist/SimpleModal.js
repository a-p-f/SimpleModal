/*!
  SimpleModal.js
  version: 2.3.0-rc
  author: Alex Fischer
  homepage: https://github.com/a-p-f/SimpleModal
*/
var SimpleModal=function(e){"use strict";var n,t=(document.documentElement.getAttribute("simple-modal-config")||"").split(" "),o=-1!=t.indexOf("autofocus"),i=-1!=t.indexOf("animate");function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e){return function(e){return null!==e&&"object"==r(e)}(e)&&e.message}function a(e,n){e.postMessage({message:n},"*")}function c(){var e=document.querySelector("[simple-modal-autofocus]");e&&e.focus()}function d(e){var n=document.documentElement,t=parseFloat(getComputedStyle(n).animationDuration);setTimeout(e,1e3*t)}window.parent!=window&&(addEventListener("message",(function(e){e.source==window.parent&&("CANCEL_SIMPLE_MODAL_ANIMATIONS"==l(e.data)&&(i&&s(),a(window.parent,"SIMPLE_MODAL_ANIMATIONS_CANCELED")))})),n=document.activeElement,document.documentElement.addEventListener("focus",(function(){n=document.activeElement}),!0),addEventListener("focus",(function(){n&&n.focus()})));var u=!1;function s(){if(!u){u=!0;var e=document.documentElement;e.classList.remove("SimpleModal-opening"),e.classList.remove("SimpleModal-animating"),o&&c()}}function m(e){var n=document.documentElement;n.classList.add("SimpleModal-closing"),n.classList.add("SimpleModal-animating"),d(e)}function f(){if(window.parent==window)throw new Error("This is not a SimpleModal child window (it's not even in iframe)")}function p(){try{return Boolean(window.parent.location.hostname)}catch(e){return!1}}function v(){var e=window.parent.SimpleModal&&window.parent.SimpleModal.layerForWindow(window);if(!e)throw new Error("This is not a SimpleModal child window");return e}function S(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(f(),p()){var t=v();return window.parent.SimpleModal.resolveLayer(t,e),void(n&&n())}if(n)throw new Error('"then" callback to SimpleModal.close is not supported in cross origin layers.');parent.postMessage({value:e,message:"CLOSE_SIMPLE_MODAL_CHILD"},"*")}function E(e){parent.postMessage({message:"REPLACE_SIMPLE_MODAL",url:e},"*")}function h(e){e._SimpleModalAriaInitialized||(e._SimpleModalAriaInitialized=!0,e._SimpleModalInitialAriaHidden=e.getAttribute("aria-hidden"),e.setAttribute("aria-hidden","true"))}function M(e){if(e._SimpleModalAriaInitialized){var n=e._SimpleModalInitialAriaHidden;null===n?e.removeAttribute("aria-hidden"):e.setAttribute("aria-hidden",n),delete e._SimpleModalAriaInitialized,delete e._SimpleModalInitialAriaHidden}}function w(e,n){var t=n.getBoundingClientRect(),o=e.style,i=document.documentElement,r=Math.max(0,t.left);o.left=r+"px",o.width=Math.min(t.right-r,i.clientWidth-r)+"px";var l=Math.max(0,t.top);o.top=l+"px",o.height=Math.min(t.bottom-l,i.clientHeight-l)+"px"}function b(e){(e.container||document.body).appendChild(e.iframe);var n=e.iframe.style;n.position="fixed",n.border="none",n.padding=0,n.zIndex=2147483647,n.zIndex=9007199254740991,e.container?(e._position=w.bind(null,e.iframe,e.container),e._position(),addEventListener("scroll",e._position,!0),addEventListener("resize",e._position)):(n.left=n.top="0px",n.width=n.height="100%")}function L(e){var n,t,o,i,r,l=e.style,a=0;function c(){e.scrollTop=n,e.scrollLeft=t}return{increment:function(){1==++a&&function(){n=e.scrollTop,t=e.scrollLeft,o=l.overflowX,i=l.overflowY,r=l.maxWidth,l.maxWidth=e.clientWidth+"px",e.scrollWidth>e.clientWidth&&(l.overflowX="hidden");e.scrollHeight>e.clientHeight&&(l.overflowY="hidden");e.addEventListener("scroll",c)}()},decrement:function(){0==--a&&(l.maxWidth=r,l.overflowX=o,l.overflowY=i,e.removeEventListener("scroll",c))}}}function g(e){e._SimpleModalScrollLock=e._SimpleModalScrollLock||L(e),e._SimpleModalScrollLock.increment()}function _(e){e._SimpleModalScrollLock.decrement()}function A(e){return e.container?[e.container]:[document.documentElement,document.body]}addEventListener("load",(function(){if(i){document.querySelector("[autofocus]")&&console.warn("autofocus not recommended when using SimpleModal animations. Can sometimes break animations in Safari, but only in certain situations.");var e=document.documentElement;e.classList.add("SimpleModal-opening"),e.classList.add("SimpleModal-animating"),d((function(){s()}))}else o&&c()}));var y="a,button,input,textarea,select,summary,[contenteditable],area,audio,video,object,embed,svg,iframe";function I(e){var n=e._SimpleModalInitialTabIndex;void 0!==n&&(null==n?e.removeAttribute("tabindex"):e.setAttribute("tabindex",n),delete e._SimpleModalInitialTabIndex)}function x(e,n){for(var t,o=function(e){return(e.container||document.body).querySelectorAll(y)}(e),i=o.length-1;i>=0;i--)o[i]!=e.iframe&&((t=o[i]).hasOwnProperty("_SimpleModalInitialTabIndex")||(t._SimpleModalInitialTabIndex=t.getAttribute("tabindex"),t.setAttribute("tabindex",-1)));e.replaces?(e.initialActiveElement=e.replaces.initialActiveElement,e.replaces.initialActiveElement=null):e.initialActiveElement=document.activeElement,e.iframe.focus()}function C(e,n){for(var t=e;t=t.nextElementSibling;)if(t._isSimpleModalIframe&&t!=n)return!0;return!!e.parentElement&&C(e.parentElement,n)}var O=[];function D(e){e.style.opacity=""}function N(e){if(!function(e){try{return Boolean(e.contentDocument)}catch(e){return!1}}(e))return!1;var n=getComputedStyle(e.contentDocument.documentElement).backgroundColor;return"transparent"==n||"rgba(0, 0, 0, 0)"==n}function P(e){var n=e.iframe;n.style.backgroundColor=N(n)?"white":"",e.replaces?a(e.iframe.contentWindow,"CANCEL_SIMPLE_MODAL_ANIMATIONS"):D(n),n!=document.activeElement&&n.focus(),e.onload&&e.onload(e.iframe.contentWindow)}function T(e){for(var n=0;n<O.length;n++)if(O[n].iframe.contentWindow==e)return O[n]}function W(e,n){var t=function(e){var n=document.createElement("iframe");return n._isSimpleModalIframe=!0,n.style.opacity=0,null!==e&&n.setAttribute("sandbox",e),n}(e.sandbox);e.iframe=t,O.push(e),function(e){A(e).forEach(g)}(e),b(e),x(e),function(e){e.iframe.setAttribute("role","dialog"),function(e,n){for(var t=e;t=t.previousElementSibling;)n(t)}(e.iframe,h)}(e),t.addEventListener("load",P.bind(null,e)),t.src=n}function R(e,n){var t=O.indexOf(e);if(-1==t)throw new Error("Layer is not in layers.");O.splice(t,1),function(e){!function(e,n){for(var t=e;t=t.nextElementSibling;)if(t._isSimpleModalIframe)return;for(t=e;t=t.previousElementSibling;)if(n(t),t._isSimpleModalIframe)return}(e.iframe,M)}(e),function(e){for(var n=document.querySelectorAll(y),t=n.length-1;t>=0;t--){var o=n[t];C(o,e.iframe)||I(o)}var i=e.initialActiveElement;i&&i.tabIndex>=0&&i.focus()}(e),function(e){e.iframe.parentElement&&e.iframe.parentElement.removeChild(e.iframe),e.container&&(removeEventListener("scroll",e._position,!0),removeEventListener("resize",e._position))}(e),function(e){A(e).forEach(_)}(e),e.onclose&&e.onclose(n),e.promiseResolver&&e.promiseResolver(n)}function k(e,n){var t={sandbox:e.sandbox,onload:e.onload,onclose:e.onclose,promiseResolver:e.promiseResolver};e.onload=null,e.onclose=null,e.promiseResolver=null,t.replaces=e,W(t,n)}return addEventListener("message",(function(e){var n=T(e.source);if(n){var t=e.data;"CLOSE_SIMPLE_MODAL_CHILD"==l(t)&&(R(n,e.data.value),closeChild(e.data.value)),"REPLACE_SIMPLE_MODAL"==l(t)&&k(n,t.url),"SIMPLE_MODAL_ANIMATIONS_CANCELED"==l(t)&&(D(n.iframe),R(n.replaces),n.replaces=null)}})),e.close=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;function t(){S(e,n)}i?m(t):t()},e.closeChild=function(e){var n=O[O.length-1];if(!n)throw new Error("No modal window is open");R(n,e)},e.layerForWindow=T,e.open=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=n.onload,o=void 0===t?null:t,i=n.onclose,r=void 0===i?null:i,l=n.sandbox,a=void 0===l?null:l,c=n.container,d=void 0===c?null:c,u={sandbox:a,onload:o,onclose:r,promiseResolver:null,container:d};W(u,e);try{return new Promise((function(e,n){u.promiseResolver=e}))}catch(e){}},e.reload=function(){E(location.href)},e.replace=E,e.replaceLayer=k,e.resolveLayer=R,e.updatePositions=function(){for(var e=0;e<O.length;e++)(n=O[e]).container&&n._position();var n},e}({});
