/*!
  SimpleModal.js
  version: 2.5.0
  author: Alex Fischer
  homepage: https://github.com/a-p-f/SimpleModal
*/
var SimpleModal=function(e){"use strict";var n=(document.documentElement.getAttribute("simple-modal-config")||"").split(" "),t=-1!=n.indexOf("autofocus"),o=-1!=n.indexOf("animate");function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return function(e){return null!==e&&"object"==i(e)}(e)&&e.message}function l(e,n){e.postMessage({message:n},"*")}function r(e,n){setTimeout(n,1e3*parseFloat(getComputedStyle(e).animationDuration))}var d=document.activeElement;function c(){var e=document.querySelector("[simple-modal-autofocus]");e&&(e.focus(),d=e)}function u(e){var n=document.documentElement,t=parseFloat(getComputedStyle(n).animationDuration);setTimeout(e,1e3*t)}window.parent!=window&&(addEventListener("message",(function(e){if(e.source==window.parent){var n=e.data;"CANCEL_SIMPLE_MODAL_ANIMATIONS"==a(n)&&(o&&m(),l(window.parent,"SIMPLE_MODAL_ANIMATIONS_CANCELED")),"SIMPLE_MODAL_LOADED_AND_REFOCUSED"==a(n)&&t&&!o&&c()}})),document.documentElement.addEventListener("focus",(function(){d=document.activeElement}),!0),addEventListener("focus",(function(){d&&d.focus()})));var s=!1;function m(){if(!s){s=!0;var e=document.documentElement;e.classList.remove("SimpleModal-opening"),e.classList.remove("SimpleModal-animating"),t&&c()}}function f(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=n.leaveBackdrop,o=void 0!==t&&t;o||l(parent,"ANIMATE_SIMPLE_MODAL_BACKDROP_OUT");var i=document.documentElement;i.classList.add("SimpleModal-closing"),i.classList.add("SimpleModal-animating"),e&&u(e)}function p(){if(window.parent==window)throw new Error("This is not a SimpleModal child window (it's not even in iframe)")}function v(){try{return Boolean(window.parent.location.hostname)}catch(e){return!1}}function E(){var e=window.parent.SimpleModal&&window.parent.SimpleModal.layerForWindow(window);if(!e)throw new Error("This is not a SimpleModal child window");return e}function S(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(p(),v()){var t=E();return window.parent.SimpleModal.resolveLayer(t,e),void(n&&n())}if(n)throw new Error('"then" callback to SimpleModal.close is not supported in cross origin layers.');parent.postMessage({value:e,message:"CLOSE_SIMPLE_MODAL_CHILD"},"*")}function M(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=n.animated,o=void 0!==t&&t;function i(){parent.postMessage({message:"REPLACE_SIMPLE_MODAL",url:e,animated:o},"*")}o?f(i,{leaveBackdrop:!0}):i()}function L(e){e._SimpleModalAriaInitialized||(e._SimpleModalAriaInitialized=!0,e._SimpleModalInitialAriaHidden=e.getAttribute("aria-hidden"),e.setAttribute("aria-hidden","true"))}function b(e){if(e._SimpleModalAriaInitialized){var n=e._SimpleModalInitialAriaHidden;null===n?e.removeAttribute("aria-hidden"):e.setAttribute("aria-hidden",n),delete e._SimpleModalAriaInitialized,delete e._SimpleModalInitialAriaHidden}}function _(e,n){var t=n.getBoundingClientRect(),o=e.style,i=document.documentElement,a=Math.max(0,t.left);o.left=a+"px",o.width=Math.min(t.right-a,i.clientWidth-a)+"px";var l=Math.max(0,t.top);o.top=l+"px",o.height=Math.min(t.bottom-l,i.clientHeight-l)+"px"}function h(e,n){(n||document.body).appendChild(e);var t=e.style;if(t.position="fixed",t.border="none",t.padding=0,t.zIndex=2147483647,t.zIndex=9007199254740991,n){var o=_.bind(null,e,n);e._simple_modal_position=o,o(),addEventListener("scroll",o,!0),addEventListener("resize",o)}else t.left=t.top="0px",t.width=t.height="100%"}function g(e,n){if(e.parentElement&&e.parentElement.removeChild(e),n){var t=e._simple_modal_position;removeEventListener("scroll",t,!0),removeEventListener("resize",t)}}function A(e){var n,t,o,i,a,l=e.style,r=0;function d(){e.scrollTop=n,e.scrollLeft=t}return{increment:function(){1==++r&&function(){n=e.scrollTop,t=e.scrollLeft,o=l.overflowX,i=l.overflowY,a=l.maxWidth,l.maxWidth=e.clientWidth+"px",e.scrollWidth>e.clientWidth&&(l.overflowX="hidden");e.scrollHeight>e.clientHeight&&(l.overflowY="hidden");e.addEventListener("scroll",d)}()},decrement:function(){0==--r&&(l.maxWidth=a,l.overflowX=o,l.overflowY=i,e.removeEventListener("scroll",d))}}}function w(e){e._SimpleModalScrollLock=e._SimpleModalScrollLock||A(e),e._SimpleModalScrollLock.increment()}function I(e){e._SimpleModalScrollLock.decrement()}function y(e){return e.container?[e.container]:[document.documentElement,document.body]}addEventListener("load",(function(){if(o){document.querySelector("[autofocus]")&&console.warn("autofocus not recommended when using SimpleModal animations. Can sometimes break animations in Safari, but only in certain situations.");var e=document.documentElement;e.classList.add("SimpleModal-opening"),e.classList.add("SimpleModal-animating"),u((function(){m()}))}else t&&c()}));var x="a,button,input,textarea,select,summary,[contenteditable],area,audio,video,object,embed,svg,iframe";function O(e){var n=e._SimpleModalInitialTabIndex;void 0!==n&&(null==n?e.removeAttribute("tabindex"):e.setAttribute("tabindex",n),delete e._SimpleModalInitialTabIndex)}function D(e,n){for(var t,o=function(e){return(e.container||document.body).querySelectorAll(x)}(e),i=o.length-1;i>=0;i--)o[i]!=e.iframe&&((t=o[i]).hasOwnProperty("_SimpleModalInitialTabIndex")||(t._SimpleModalInitialTabIndex=t.getAttribute("tabindex"),t.setAttribute("tabindex",-1)));e.replaces?(e.initialActiveElement=e.replaces.initialActiveElement,e.replaces.initialActiveElement=null):e.initialActiveElement=document.activeElement,e.iframe.focus()}function C(e,n){for(var t=e;t=t.nextElementSibling;)if(t._isSimpleModalIframe&&t!=n)return!0;return!!e.parentElement&&C(e.parentElement,n)}var k=[];function P(e){e.style.opacity=""}function T(e){if(!function(e){try{return Boolean(e.contentDocument)}catch(e){return!1}}(e))return!1;var n=getComputedStyle(e.contentDocument.documentElement),t=n.backgroundColor;return("transparent"==t||"rgba(0, 0, 0, 0)"==t)&&"none"==n.backgroundImage}function N(e){var n=e.iframe;n.style.backgroundColor=T(n)?"white":"",e.replaces?l(n.contentWindow,"CANCEL_SIMPLE_MODAL_ANIMATIONS"):P(n),n!=document.activeElement&&-1!=n.tabindex&&n.focus(),l(n.contentWindow,"SIMPLE_MODAL_LOADED_AND_REFOCUSED"),e.onload&&e.onload(e.iframe.contentWindow)}function R(e){for(var n=0;n<k.length;n++)if(k[n].iframe.contentWindow==e)return k[n]}function W(e,n){e.backdrop||function(e){var n=document.createElement("div");n.classList.add("SimpleModalBackdrop"),n.classList.add("animating"),h(n,e.container),r(n,(function(){n.classList.remove("animating")})),e.backdrop=n}(e);var t=function(e){var n=document.createElement("iframe");return n.classList.add("SimpleModalIframe"),n._isSimpleModalIframe=!0,n.style.opacity=0,null!==e&&n.setAttribute("sandbox",e),n}(e.sandbox);e.iframe=t,k.push(e),function(e){y(e).forEach(w)}(e),h(e.iframe,e.container),D(e),function(e){e.iframe.setAttribute("role","dialog"),function(e,n){for(var t=e;t=t.previousElementSibling;)n(t)}(e.iframe,L)}(e),t.addEventListener("load",N.bind(null,e)),t.src=n}function z(e,n){var t=k.indexOf(e);if(-1==t)throw new Error("Layer is not in layers.");k.splice(t,1);var o=e.backdrop;o&&H(o,e.container),function(e){!function(e,n){for(var t=e;t=t.nextElementSibling;)if(t._isSimpleModalIframe)return;for(t=e;t=t.previousElementSibling;)if(n(t),t._isSimpleModalIframe)return}(e.iframe,b)}(e),function(e){for(var n=document.querySelectorAll(x),t=n.length-1;t>=0;t--){var o=n[t];C(o,e.iframe)||O(o)}var i=e.initialActiveElement;i&&i.tabIndex>=0&&i.focus()}(e),g(e.iframe,e.container),function(e){y(e).forEach(I)}(e),e.onclose&&e.onclose(n),e.promiseResolver&&e.promiseResolver(n)}function B(e,n){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o={sandbox:e.sandbox,onload:e.onload,onclose:e.onclose,promiseResolver:e.promiseResolver,backdrop:e.backdrop};e.onload=null,e.onclose=null,e.promiseResolver=null,e.backdrop=null,t?(e.onclose=W.bind(null,o,n),z(e)):(o.replaces=e,W(o,n))}function H(e,n){g(e,n)}return addEventListener("message",(function(e){var n=R(e.source);if(n){var t=e.data;"CLOSE_SIMPLE_MODAL_CHILD"==a(t)&&(z(n,e.data.value),closeChild(e.data.value)),"REPLACE_SIMPLE_MODAL"==a(t)&&B(n,t.url,t.animated),"SIMPLE_MODAL_ANIMATIONS_CANCELED"==a(t)&&(P(n.iframe),z(n.replaces),n.replaces=null),"ANIMATE_SIMPLE_MODAL_BACKDROP_OUT"==a(t)&&function(e){var n=e.backdrop;n&&(e.backdrop=null,n.classList.add("animating"),n.classList.add("closing"),r(n,H.bind(null,n,e.container)))}(n)}})),e.animateOut=f,e.close=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;function t(){S(e,n)}o?f(t):t()},e.closeChild=function(e){var n=k[k.length-1];if(!n)throw new Error("No modal window is open");z(n,e)},e.layerForWindow=R,e.open=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=n.onload,o=void 0===t?null:t,i=n.onclose,a=void 0===i?null:i,l=n.sandbox,r=void 0===l?null:l,d=n.container,c=void 0===d?null:d,u={sandbox:r,onload:o,onclose:a,promiseResolver:null,container:c};W(u,e);try{return new Promise((function(e,n){u.promiseResolver=e}))}catch(e){}},e.reload=function(){M(location.href)},e.replace=M,e.replaceLayer=B,e.resolveLayer=z,e.updatePositions=function(){for(var e=0;e<k.length;e++)n=k[e].iframe,k[e].container&&n._simple_modal_position();var n},e}({});
